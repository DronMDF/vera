<?xml version="1.0" encoding="ISO-8859-1"?>
<rule name="T010" last-updated="2006.12.21">

<title>Function calls and declarations should not have any tokens between function name and opening parenthesis</title>

<description>
<p>In a function declaration or call, the function name and opening parenthesis shuold be adjacent, without any additional token:</p>
<example>
void foo();
void bar() { foo(); }
</example>
</description>

<compliance>
<standard name="Inspirel" />
</compliance>

<script><![CDATA[# Function calls and declarations should not have unnecessary tokens between function name and parenthesis

foreach f [getSourceFileNames] {
    set state "paren"
    foreach t [getTokens $f 1 0 -1 -1 {identifier leftparen}] {
        set name [lindex $t 3]
        if {$name == "leftparen"} {
            if {$state == "identifier"} {
                set parenLine [lindex $t 1]
                set parenColumn [lindex $t 2]
                set between [getTokens $f $identifierLine [expr $identifierColumn + [string length $identifier]] \
                             $parenLine $parenColumn {}]
                set nonEmptyTokens false
                foreach b $between {
                    if {[lsearch {space newline ccomment cppcomment} [lindex $b 3]] == -1} {
                        set nonEmptyTokens true
                    }
                }
                if {$between != {} && $nonEmptyTokens == "false"} {
                    report $f $identifierLine "function name not immediately followed by opening parenthesis"
                }
            }
            set state "paren"
        } else {
            set identifier [lindex $t 0]
            set identifierLine [lindex $t 1]
            set identifierColumn [lindex $t 2]
            set state "identifier"
        }
    }
}
]]></script>

<test>

<source><![CDATA[@ test.cpp
void foo();
int a, b;
void bar() { foo(); }
void foo ();
void baz () { foo (); }
]]></source>

<result><![CDATA[test.cpp:4: function name not immediately followed by opening parenthesis
test.cpp:5: function name not immediately followed by opening parenthesis
test.cpp:5: function name not immediately followed by opening parenthesis
]]></result>

</test>
</rule>
