<?xml version="1.0" encoding="ISO-8859-1"?>
<rule name="T006" last-updated="2006.12.19">

<title>Keywords return and throw should be immediately followed by a semicolon or a single space</title>

<description>
<p>The <code>return</code> and <code>throw</code> keywords should be immediately followed by a semicolon or a single space:</p>
<example>
void fun()
{
     if (...)
     {
          return;
     }
     // ...
}

int add(int a, int b)
{
     return a + b;
}
</example>
<p>An exception to this rule is allowed for exeption specifications:</p>
<example>
void fun() throw();
</example>
</description>

<compliance>
<standard name="Inspirel" />
</compliance>

<script><![CDATA[# Keywords return and throw should be immediately followed by a semicolon or a single space

foreach f [getSourceFileNames] {
    foreach t [getTokens $f 1 0 -1 -1 {return throw}] {
        set keyword [lindex $t 0]
        set line [lindex $t 1]
        set column [lindex $t 2]
        set followingTokens [getTokens $f $line [expr $column + [string length $keyword]] [expr $line + 1] 0 {}]
        if {$followingTokens == {}} {
            report $f $line "keyword '${keyword}' not immediately followed by a semicolon or a single space"
        } else {
            set first [lindex [lindex $followingTokens 0] 0]
            if {$first != ";" && $first != " " && !($keyword == "throw" && $first == "(")} {
                report $f $line "keyword '${keyword}' not immediately followed by a semicolon or a single space"
            }
        }
    }
}
]]></script>

<test>

<source><![CDATA[@ test.cpp
void foo() throw()
{
    return;
    return ;
    return  ;
    return 7;
    return
    7;
    throw;
    throw ;
    throw  ;
    throw 7;
    throw
    7;
}
]]></source>

<result><![CDATA[test.cpp:5: keyword 'return' not immediately followed by a semicolon or a single space
test.cpp:7: keyword 'return' not immediately followed by a semicolon or a single space
test.cpp:11: keyword 'throw' not immediately followed by a semicolon or a single space
test.cpp:13: keyword 'throw' not immediately followed by a semicolon or a single space
]]></result>

</test>
</rule>
